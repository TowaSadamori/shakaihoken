<button class="home-button" (click)="goBack()">戻る</button>

<h2 class="page-title">賞与 社会保険料計算</h2>

<div class="calculation-container">
  <!-- 従業員情報表示エリア -->
  <div class="employee-info-section" *ngIf="employeeInfo">
    <h3>従業員情報</h3>
    <div class="info-grid">
      <div class="info-item">
        <span class="info-label">従業員番号:</span>
        <span>{{ employeeInfo.employeeNumber }}</span>
      </div>
      <div class="info-item">
        <span class="info-label">氏名:</span>
        <span>{{ employeeInfo.name }}</span>
      </div>
      <div class="info-item">
        <span class="info-label">年齢:</span>
        <span>{{ employeeInfo.age }}歳</span>
      </div>
      <div class="info-item">
        <span class="info-label">事業所所在地:</span>
        <span>{{ employeeInfo.addressPrefecture }}</span>
      </div>
      <div class="info-item">
        <span class="info-label">計算対象年度:</span>
        <span>{{ selectedYear }}年度</span>
      </div>
    </div>
  </div>

  <!-- 賞与情報入力エリア -->
  <div class="bonus-input-section">
    <h3>賞与情報入力</h3>
    <div class="input-form">
      <div class="form-row">
        <label for="bonus-amount" class="form-label">賞与支給額 (円):</label>
        <input
          type="number"
          id="bonus-amount"
          class="form-input"
          [(ngModel)]="bonusAmount"
          placeholder="例: 500000"
          min="0"
          step="1"
        />
      </div>

      <div class="form-row">
        <label for="payment-date" class="form-label">支給年月:</label>
        <input type="month" id="payment-date" class="form-input" [(ngModel)]="paymentDate" />
      </div>

      <div class="form-row">
        <label for="bonus-type" class="form-label">賞与種別:</label>
        <select id="bonus-type" class="form-select" [(ngModel)]="bonusType">
          <option value="">選択してください</option>
          <option value="summer">夏季賞与</option>
          <option value="winter">冬季賞与</option>
          <option value="settlement">決算賞与</option>
          <option value="other">その他</option>
        </select>
      </div>
    </div>

    <div class="calculate-button-area">
      <button class="calculate-btn" (click)="calculateInsurance()" [disabled]="!isFormValid()">
        保険料を計算する
      </button>
    </div>
  </div>

  <!-- 計算結果表示エリア -->
  <div class="result-section" *ngIf="calculationResult">
    <h3>計算結果</h3>
    <div class="result-content">
      <div class="standard-bonus-info">
        <h4>標準賞与額</h4>
        <div class="amount-display">
          {{ calculationResult.standardBonusAmount | number: '1.0-0' }}円
        </div>
        <p class="note">※1,000円未満切り捨て</p>
      </div>

      <div class="insurance-breakdown">
        <h4>保険料内訳</h4>
        <div class="breakdown-table">
          <div class="breakdown-row header">
            <div class="col-type">保険種別</div>
            <div class="col-rate">料率</div>
            <div class="col-employee">個人負担</div>
            <div class="col-company">会社負担</div>
            <div class="col-total">合計</div>
          </div>

          <div class="breakdown-row">
            <div class="col-type">健康保険</div>
            <div class="col-rate">{{ calculationResult.healthInsurance.rate }}%</div>
            <div class="col-employee">
              {{ calculationResult.healthInsurance.employeeBurden | number: '1.0-0' }}円
            </div>
            <div class="col-company">
              {{ calculationResult.healthInsurance.companyBurden | number: '1.0-0' }}円
            </div>
            <div class="col-total">
              {{ calculationResult.healthInsurance.total | number: '1.0-0' }}円
            </div>
          </div>

          <div class="breakdown-row">
            <div class="col-type">厚生年金保険</div>
            <div class="col-rate">{{ calculationResult.pensionInsurance.rate }}%</div>
            <div class="col-employee">
              {{ calculationResult.pensionInsurance.employeeBurden | number: '1.0-0' }}円
            </div>
            <div class="col-company">
              {{ calculationResult.pensionInsurance.companyBurden | number: '1.0-0' }}円
            </div>
            <div class="col-total">
              {{ calculationResult.pensionInsurance.total | number: '1.0-0' }}円
            </div>
          </div>

          <div class="breakdown-row" *ngIf="calculationResult.careInsurance">
            <div class="col-type">介護保険</div>
            <div class="col-rate">{{ calculationResult.careInsurance.rate }}%</div>
            <div class="col-employee">
              {{ calculationResult.careInsurance.employeeBurden | number: '1.0-0' }}円
            </div>
            <div class="col-company">
              {{ calculationResult.careInsurance.companyBurden | number: '1.0-0' }}円
            </div>
            <div class="col-total">
              {{ calculationResult.careInsurance.total | number: '1.0-0' }}円
            </div>
          </div>

          <div class="breakdown-row total-row">
            <div class="col-type">合計</div>
            <div class="col-rate">-</div>
            <div class="col-employee">
              {{ calculationResult.totalEmployeeBurden | number: '1.0-0' }}円
            </div>
            <div class="col-company">
              {{ calculationResult.totalCompanyBurden | number: '1.0-0' }}円
            </div>
            <div class="col-total">{{ calculationResult.totalInsurance | number: '1.0-0' }}円</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- エラーメッセージ -->
  <div class="error-message" *ngIf="errorMessage">
    {{ errorMessage }}
  </div>
</div>
