<div class="judgment-container">
  <div class="header-container">
    <button class="btn-back" (click)="goBack()">
      <i class="icon-arrow-left"></i>
      å¾“æ¥­å“¡ä¸€è¦§ã«æˆ»ã‚‹
    </button>
    <h2>ç¤¾ä¼šä¿é™ºå¯¾è±¡è€…åˆ¤å®š</h2>
  </div>

  <!-- å¯¾è±¡è€…æƒ…å ± -->
  <div class="employee-info">
    <h3>å¯¾è±¡è€…æƒ…å ±</h3>
    <div class="info-grid">
      <div class="info-item">
        <div class="label">å¾“æ¥­å“¡å:</div>
        <span>{{ employeeName }}</span>
      </div>
      <div class="info-item">
        <div class="label">å¾“æ¥­å“¡ç•ªå·:</div>
        <span>{{ employeeNumber }}</span>
      </div>
      <div class="info-item">
        <div class="label">ç”Ÿå¹´æœˆæ—¥:</div>
        <span>{{ birthDate }}</span>
      </div>
      <div class="info-item">
        <div class="label">å¹´é½¢:</div>
        <span>{{ age }}æ­³</span>
      </div>
      <div class="info-item">
        <div class="label">äº‹æ¥­æ‰€ç•ªå·:</div>
        <span>{{ officeNumber }}</span>
      </div>
      <div class="info-item">
        <div class="label">äº‹æ¥­æ‰€æ‰€åœ¨åœ°:</div>
        <span>{{ officePrefecture }}</span>
      </div>
    </div>
  </div>

  <!-- å±æ€§ç·¨é›†ãƒœã‚¿ãƒ³ -->
  <div class="attribute-edit-section" *ngIf="!showQuestionnaire && !judgmentResult">
    <div class="edit-prompt">
      <p>å¾“æ¥­å“¡ã®å±æ€§ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«è³ªå•ã«ç­”ãˆã¦ãã ã•ã„</p>
      <button class="btn-primary" (click)="startAttributeEdit()">å±æ€§ã‚’ç·¨é›†ã™ã‚‹</button>
    </div>
  </div>

  <!-- è³ªå•ã‚¨ãƒªã‚¢ -->
  <div class="questionnaire" *ngIf="showQuestionnaire && currentQuestion">
    <h3>è³ªå• {{ getQuestionNumber() }}</h3>

    <!-- ãƒ‡ãƒãƒƒã‚°æƒ…å ± -->
    <div
      class="debug-info"
      style="
        background: #fff3cd;
        padding: 1rem;
        margin-bottom: 1rem;
        border-radius: 4px;
        position: relative;
      "
      *ngIf="showDebugInfo"
    >
      <button
        (click)="hideDebugInfo()"
        style="
          position: absolute;
          top: 0.5rem;
          right: 0.5rem;
          background: #dc3545;
          color: white;
          border: none;
          border-radius: 3px;
          padding: 0.25rem 0.5rem;
          cursor: pointer;
        "
      >
        âœ• é–‰ã˜ã‚‹
      </button>
      <strong>ğŸ” ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒãƒƒã‚°æƒ…å ±:</strong><br />
      ğŸ“‹ ç¾åœ¨ã®è³ªå•ID: {{ currentQuestionId }}<br />
      â“ ç¾åœ¨ã®è³ªå•ãƒ†ã‚­ã‚¹ãƒˆ: {{ currentQuestion.text }}<br />
      ğŸ“ ç¾åœ¨ã®è³ªå•ã®å›ç­”: {{ answers[currentQuestionId] }}<br />
      ğŸ“š è³ªå•å±¥æ­´: {{ questionHistory | json }}<br />
      ğŸ“Š å±¥æ­´ã®é•·ã•: {{ questionHistory.length }}<br />
      â¬…ï¸ æˆ»ã‚‹ã“ã¨ãŒã§ãã‚‹: {{ canGoToPreviousQuestion }}<br />
      ğŸ” nextQuestionè¨­å®š: {{ currentQuestion.nextQuestion | json }}<br />
      ğŸ“ å…¨å›ç­”ãƒ‡ãƒ¼ã‚¿: {{ answers | json }}<br />
      ğŸ¯ é›‡ç”¨å½¢æ…‹: {{ answers['employmentType'] }}<br />
      <button (click)="debugCurrentState()" style="margin-top: 0.5rem; padding: 0.25rem 0.5rem">
        è©³ç´°ãƒ‡ãƒãƒƒã‚°
      </button>
    </div>

    <!-- å‰ã®è³ªå•ã«æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
    <div class="question-navigation" *ngIf="canGoToPreviousQuestion">
      <button class="btn-previous" (click)="goToPreviousQuestion()">
        <i class="icon-arrow-left"></i>
        å‰ã®è³ªå•ã«æˆ»ã‚‹
      </button>
    </div>

    <div class="questions">
      <div class="question-item">
        <div class="question-text">{{ currentQuestion.text }}</div>

        <!-- é¸æŠå¼è³ªå• -->
        <div class="answer-options" *ngIf="currentQuestion.type === 'choice'">
          <label *ngFor="let choice of currentQuestion.choices">
            <input
              type="radio"
              [name]="currentQuestion.id"
              [value]="choice.value"
              [(ngModel)]="answers[currentQuestion.id]"
              (change)="updateAnswers()"
            />
            {{ choice.label }}
          </label>
        </div>

        <!-- ã¯ã„/ã„ã„ãˆè³ªå• -->
        <div class="answer-options" *ngIf="currentQuestion.type === 'yesno'">
          <label>
            <input
              type="radio"
              [name]="currentQuestion.id"
              value="yes"
              [(ngModel)]="answers[currentQuestion.id]"
              (change)="logChangeEvent('ã¯ã„', currentQuestion.id); updateAnswers()"
              (click)="
                logRadioClick('ã¯ã„', currentQuestion.id);
                handleRadioClick('yes', currentQuestion.id)
              "
            />
            ã¯ã„
          </label>
          <label>
            <input
              type="radio"
              [name]="currentQuestion.id"
              value="no"
              [(ngModel)]="answers[currentQuestion.id]"
              (change)="logChangeEvent('ã„ã„ãˆ', currentQuestion.id); updateAnswers()"
              (click)="
                logRadioClick('ã„ã„ãˆ', currentQuestion.id);
                handleRadioClick('no', currentQuestion.id)
              "
            />
            ã„ã„ãˆ
          </label>
        </div>

        <!-- æ—¥ä»˜ç¯„å›²è³ªå• -->
        <div class="date-range-options" *ngIf="currentQuestion.type === 'date-range'">
          <div class="period-selection">
            <div class="date-input-section">
              <h4>æœŸé–“ã‚’æŒ‡å®šã—ã¦ãã ã•ã„</h4>
              <div class="date-inputs">
                <div class="date-field">
                  <div class="field-label">é–‹å§‹æ—¥:</div>
                  <input type="date" #startDate class="date-input" />
                </div>
                <div class="date-field">
                  <div class="field-label">çµ‚äº†äºˆå®šæ—¥:</div>
                  <input type="date" #endDate class="date-input" />
                </div>
              </div>
              <button
                class="period-button custom-button"
                (click)="updateDateRange(startDate.value, endDate.value)"
                [disabled]="!startDate.value || !endDate.value"
              >
                æœŸé–“ã‚’è¨­å®šã—ã¦æ¬¡ã¸
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- åˆ¤å®šçµæœ -->
  <div class="judgment-result" *ngIf="judgmentResult">
    <div class="result-header">
      <h3>åˆ¤å®šçµæœ</h3>
      <div class="result-buttons">
        <button class="btn-reset" (click)="resetQuestionnaire()">
          <i class="icon-refresh"></i>
          åˆ¤å®šã‚’ã‚„ã‚Šç›´ã™
        </button>
        <button class="btn-save" (click)="saveJudgment()">
          <i class="icon-save"></i>
          åˆ¤å®šçµæœã‚’ä¿å­˜
        </button>
      </div>
    </div>

    <!-- åˆ¤å®šçµæœãƒ‡ãƒãƒƒã‚°æƒ…å ± -->
    <div
      class="debug-info"
      style="
        background: #e7f3ff;
        padding: 1rem;
        margin-bottom: 1rem;
        border-radius: 4px;
        position: relative;
      "
      *ngIf="showDebugInfo"
    >
      <button
        (click)="hideDebugInfo()"
        style="
          position: absolute;
          top: 0.5rem;
          right: 0.5rem;
          background: #dc3545;
          color: white;
          border: none;
          border-radius: 3px;
          padding: 0.25rem 0.5rem;
          cursor: pointer;
        "
      >
        âœ• é–‰ã˜ã‚‹
      </button>
      <strong>ğŸ” åˆ¤å®šçµæœãƒ‡ãƒãƒƒã‚°æƒ…å ±:</strong><br />
      ğŸ“ å…¨å›ç­”ãƒ‡ãƒ¼ã‚¿: {{ answers | json }}<br />
      ğŸ¯ é›‡ç”¨å½¢æ…‹: {{ answers['employmentType'] }}<br />
      ğŸ“š è³ªå•å±¥æ­´: {{ questionHistory | json }}<br />
      ğŸ¥ å¥åº·ä¿é™ºåˆ¤å®š: {{ judgmentResult.healthInsurance | json }}<br />
      ğŸ›ï¸ åšç”Ÿå¹´é‡‘åˆ¤å®š: {{ judgmentResult.pensionInsurance | json }}<br />
      ğŸ§“ ä»‹è­·ä¿é™ºåˆ¤å®š: {{ judgmentResult.careInsurance | json }}<br />
      ğŸ“… å¹´é½¢: {{ age }}æ­³<br />
      ğŸ¢ ä¼‘è·çŠ¶æ³: {{ answers['leaveStatus'] }}<br />
      ğŸ“‹ æ‰‹å…¥åŠ›å¥åº·ä¿é™º: {{ answers['manualHealthInsurance'] }}<br />
      ğŸ“‹ æ‰‹å…¥åŠ›åšç”Ÿå¹´é‡‘: {{ answers['manualPensionInsurance'] }}<br />
      <button (click)="debugCurrentState()" style="margin-top: 0.5rem; padding: 0.25rem 0.5rem">
        è©³ç´°ãƒ‡ãƒãƒƒã‚°
      </button>
    </div>

    <!-- ä¼‘è·æƒ…å ±è¡¨ç¤º -->
    <div class="leave-info" *ngIf="getLeaveInfo()">
      <h4>ä¼‘è·æƒ…å ±</h4>
      <div class="leave-details">
        <div class="leave-type">
          <span class="label">ä¼‘è·ç¨®åˆ¥:</span>
          <span class="value">{{ getLeaveTypeLabel() }}</span>
        </div>
        <div class="leave-period" *ngIf="getLeavePeriodInfo()">
          <span class="label">å…é™¤æœŸé–“:</span>
          <span class="value">{{ getLeavePeriodInfo() }}</span>
        </div>
      </div>
    </div>

    <div class="result-cards">
      <div class="result-card">
        <h4>å¥åº·ä¿é™ºæ–™</h4>
        <div
          class="status"
          [class]="judgmentResult.healthInsurance.eligible ? 'eligible' : 'not-eligible'"
        >
          {{ judgmentResult.healthInsurance.eligible ? 'åŠ å…¥å¯¾è±¡' : 'åŠ å…¥å¯¾è±¡å¤–' }}
        </div>
        <p>{{ judgmentResult.healthInsurance.reason }}</p>
      </div>

      <div class="result-card">
        <h4>ä»‹è­·ä¿é™ºæ–™</h4>
        <div
          class="status"
          [class]="judgmentResult.careInsurance?.eligible ? 'eligible' : 'not-eligible'"
        >
          {{ judgmentResult.careInsurance?.eligible ? 'åŠ å…¥å¯¾è±¡' : 'åŠ å…¥å¯¾è±¡å¤–' }}
        </div>
        <p>{{ judgmentResult.careInsurance?.reason }}</p>
      </div>

      <div class="result-card">
        <h4>åšç”Ÿå¹´é‡‘ä¿é™ºæ–™</h4>
        <div
          class="status"
          [class]="judgmentResult.pensionInsurance.eligible ? 'eligible' : 'not-eligible'"
        >
          {{ judgmentResult.pensionInsurance.eligible ? 'åŠ å…¥å¯¾è±¡' : 'åŠ å…¥å¯¾è±¡å¤–' }}
        </div>
        <p>{{ judgmentResult.pensionInsurance.reason }}</p>
      </div>
    </div>
  </div>

  <!-- è¿½åŠ è³ªå•ï¼ˆç¤¾ä¼šä¿é™ºåŠ å…¥å¯¾è±¡è€…ã®ã¿ï¼‰ -->
  <div class="additional-questions" *ngIf="judgmentResult && isInsuranceEligible()">
    <div class="section-header">
      <h3>è¿½åŠ æƒ…å ±ã®å…¥åŠ›</h3>
      <p>è©²å½“ã™ã‚‹äº‹ä¾‹ãŒã‚ã‚‹å ´åˆã¯é¸æŠã—ã¦ãã ã•ã„ï¼ˆä»»æ„ï¼‰</p>
    </div>

    <div class="special-cases">
      <div class="case-item" *ngFor="let specialCase of selectedSpecialCases; let i = index">
        <div class="case-header" *ngIf="selectedSpecialCases.length > 1">
          <button class="btn-remove" (click)="removeSpecialCase(i)">
            <i class="icon-close"></i>
            å‰Šé™¤
          </button>
        </div>

        <div class="case-selection">
          <label [for]="'case-type-' + i">äº‹ä¾‹ã®ç¨®é¡:</label>
          <select
            [id]="'case-type-' + i"
            [(ngModel)]="specialCase.type"
            (change)="onSpecialCaseTypeChange(i)"
          >
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="maternity-leave">ç”£å‰ç”£å¾Œä¼‘æ¥­æœŸé–“ä¸­ã®ä¿é™ºæ–™å…é™¤</option>
            <option value="childcare-leave">è‚²ä¼‘</option>
            <option value="other-leave">ãã®ä»–ã®ä¼‘è·</option>
            <option value="secondment">å‡ºå‘è€…ã®ç¤¾ä¼šä¿é™ºåŠ å…¥</option>
            <option value="multiple-workplace">äºŒä»¥ä¸Šäº‹æ¥­æ‰€å‹¤å‹™è€…</option>
            <option value="same-day-acquisition-loss">åŒæ—¥å¾—å–ª</option>
          </select>
        </div>

        <!-- ç”£å‰ç”£å¾Œä¼‘æ¥­ã®è©³ç´°ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="case-details" *ngIf="specialCase.type === 'maternity-leave'">
          <div class="form-grid">
            <div class="form-group">
              <label [for]="'pregnancy-type-' + i">å¦Šå¨ ã®ç¨®é¡:</label>
              <select
                [id]="'pregnancy-type-' + i"
                [(ngModel)]="specialCase.details.pregnancyType"
                (change)="calculateMaternityPeriod(i)"
              >
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="single">å˜èƒ</option>
                <option value="multiple">å¤šèƒ</option>
              </select>
            </div>

            <div class="form-group">
              <label [for]="'expected-birth-date-' + i">å‡ºç”£äºˆå®šæ—¥:</label>
              <input
                [id]="'expected-birth-date-' + i"
                type="date"
                [(ngModel)]="specialCase.details.expectedBirthDate"
                (change)="calculateMaternityPeriod(i)"
              />
            </div>

            <div class="form-group">
              <label [for]="'actual-birth-date-' + i">å®Ÿéš›ã®å‡ºç”£æ—¥ï¼ˆä»»æ„ï¼‰:</label>
              <input
                [id]="'actual-birth-date-' + i"
                type="date"
                [(ngModel)]="specialCase.details.actualBirthDate"
                (change)="calculateMaternityPeriod(i); onActualBirthDateChange(i)"
              />
            </div>

            <!-- è¨ˆç®—ã•ã‚ŒãŸæœ€å¤§æœŸé–“è¡¨ç¤º -->
            <div class="form-group full-width" *ngIf="getCalculatedMaternityPeriod(i)">
              <div class="calculated-period">
                <h5>æ³•å®šæœ€å¤§æœŸé–“ï¼ˆå‚è€ƒï¼‰</h5>
                <div class="period-info">
                  <div class="period-item">
                    <span class="label">ç”£å‰æœŸé–“:</span>
                    <span class="value">{{ getCalculatedMaternityPeriod(i)?.preNatalPeriod }}</span>
                  </div>
                  <div class="period-item">
                    <span class="label">ç”£å¾ŒæœŸé–“:</span>
                    <span class="value">{{
                      getCalculatedMaternityPeriod(i)?.postNatalPeriod
                    }}</span>
                  </div>
                  <div class="period-item total">
                    <span class="label">æœ€å¤§å…é™¤æœŸé–“:</span>
                    <span class="value">{{ getCalculatedMaternityPeriod(i)?.totalPeriod }}</span>
                  </div>
                  <div class="period-item exemption">
                    <span class="label">ç¤¾ä¼šä¿é™ºæ–™å…é™¤æœŸé–“:</span>
                    <span class="value">{{
                      getCalculatedMaternityPeriod(i)?.exemptionPeriod
                    }}</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- å®Ÿéš›ã®ç”³è«‹æœŸé–“é¸æŠ -->
            <div class="form-group full-width" *ngIf="getCalculatedMaternityPeriod(i)">
              <div class="actual-period-selection">
                <h5>å®Ÿéš›ã®ç¤¾ä¼šä¿é™ºæ–™å…é™¤æœŸé–“</h5>

                <!-- ç”£å‰ãƒ»ç”£å¾ŒæœŸé–“ã®å…¥åŠ› -->
                <div class="period-breakdown">
                  <div class="period-section prenatal">
                    <div class="period-header">
                      <span class="period-title">ç”£å‰ã®æœŸé–“</span>
                      <div class="period-inputs">
                        <input
                          type="date"
                          [(ngModel)]="specialCase.details.preNatalStartDate"
                          [value]="specialCase.details.preNatalStartDate || getPreNatalStartDate(i)"
                          (ngModelChange)="onPreNatalStartDateChange(i, $event)"
                          class="period-date-input"
                          placeholder="é–‹å§‹æ—¥"
                        />
                        <span class="date-separator">ï½</span>
                        <input
                          type="date"
                          [(ngModel)]="specialCase.details.preNatalEndDate"
                          [value]="specialCase.details.preNatalEndDate || getPreNatalEndDate(i)"
                          (ngModelChange)="onPreNatalEndDateChange(i, $event)"
                          class="period-date-input"
                          placeholder="çµ‚äº†æ—¥"
                        />
                      </div>
                    </div>
                  </div>
                  <div class="period-section postnatal">
                    <div class="period-header">
                      <span class="period-title">ç”£å¾Œã®æœŸé–“</span>
                      <div class="period-inputs">
                        <input
                          type="date"
                          [(ngModel)]="specialCase.details.postNatalStartDate"
                          [value]="
                            specialCase.details.postNatalStartDate || getPostNatalStartDate(i)
                          "
                          (ngModelChange)="onPostNatalStartDateChange(i, $event)"
                          class="period-date-input"
                          placeholder="é–‹å§‹æ—¥"
                        />
                        <span class="date-separator">ï½</span>
                        <input
                          type="date"
                          [(ngModel)]="specialCase.details.postNatalEndDate"
                          [value]="specialCase.details.postNatalEndDate || getPostNatalEndDate(i)"
                          [min]="getPostNatalStartDate(i)"
                          [max]="getPostNatalMaxDate(i)"
                          (ngModelChange)="onPostNatalEndDateChange(i, $event)"
                          class="period-date-input"
                          placeholder="çµ‚äº†æ—¥"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <!-- ç¤¾ä¼šä¿é™ºæ–™å…é™¤æœŸé–“ã®è¡¨ç¤º -->
                <div class="exemption-period-display">
                  <div class="exemption-bar">
                    <span class="exemption-label">ç¤¾ä¼šä¿é™ºæ–™å…é™¤æœŸé–“:</span>
                    <span class="exemption-period">{{ getActualExemptionPeriod(i) }}</span>
                  </div>
                </div>

                <div
                  class="selected-period-info"
                  *ngIf="specialCase.details.actualStartDate && specialCase.details.actualEndDate"
                >
                  <div class="info-item">
                    <span class="label">é¸æŠã•ã‚ŒãŸæœŸé–“:</span>
                    <span class="value"
                      >{{ specialCase.details.actualStartDate }} ï½
                      {{ specialCase.details.actualEndDate }}</span
                    >
                  </div>
                  <div class="info-item">
                    <span class="label">ç”³è«‹æ—¥æ•°:</span>
                    <span class="value">{{ getSelectedPeriodDays(i) }}æ—¥é–“</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-group full-width">
              <label [for]="'maternity-remarks-' + i">å‚™è€ƒ:</label>
              <textarea
                [id]="'maternity-remarks-' + i"
                [(ngModel)]="specialCase.details.remarks"
                placeholder="ç”£å‰ç”£å¾Œä¼‘æ¥­ã«é–¢ã™ã‚‹ç‰¹è¨˜äº‹é …ãªã©"
              ></textarea>
            </div>
          </div>

          <!-- ç”£å‰ç”£å¾Œä¼‘æ¥­ã®ä¿å­˜ãƒœã‚¿ãƒ³ -->
          <div class="case-save-section">
            <button
              class="btn-save-case"
              (click)="saveSpecialCase(i)"
              [disabled]="!canSaveMaternityCase(i)"
            >
              <i class="icon-save"></i>
              ã“ã®æƒ…å ±ã‚’ä¿å­˜
            </button>
            <div class="save-status" *ngIf="specialCase.saveStatus">
              <span class="status-icon" [class]="specialCase.saveStatus">
                {{
                  specialCase.saveStatus === 'saved'
                    ? 'âœ“'
                    : specialCase.saveStatus === 'saving'
                      ? 'â³'
                      : 'âœ—'
                }}
              </span>
              <span class="status-text">
                {{ getSpecialCaseSaveStatusText(specialCase.saveStatus) }}
              </span>
            </div>
          </div>
        </div>

        <!-- è‚²ä¼‘ã®è©³ç´°ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="case-details" *ngIf="specialCase.type === 'childcare-leave'">
          <div class="form-grid">
            <div class="form-group">
              <label [for]="'childcare-start-' + i">é–‹å§‹æ—¥:</label>
              <input
                [id]="'childcare-start-' + i"
                type="date"
                [(ngModel)]="specialCase.details.startDate"
              />
            </div>

            <div class="form-group">
              <label [for]="'childcare-end-' + i">çµ‚äº†äºˆå®šæ—¥:</label>
              <input
                [id]="'childcare-end-' + i"
                type="date"
                [(ngModel)]="specialCase.details.endDate"
              />
            </div>

            <div class="form-group full-width">
              <label [for]="'childcare-remarks-' + i">å‚™è€ƒ:</label>
              <textarea
                [id]="'childcare-remarks-' + i"
                [(ngModel)]="specialCase.details.remarks"
                placeholder="è‚²ä¼‘ã«é–¢ã™ã‚‹ç‰¹è¨˜äº‹é …ãªã©"
              ></textarea>
            </div>
          </div>

          <!-- è‚²ä¼‘ã®ä¿å­˜ãƒœã‚¿ãƒ³ -->
          <div class="case-save-section">
            <button
              class="btn-save-case"
              (click)="saveSpecialCase(i)"
              [disabled]="!canSaveChildcareCase(i)"
            >
              <i class="icon-save"></i>
              ã“ã®æƒ…å ±ã‚’ä¿å­˜
            </button>
            <div class="save-status" *ngIf="specialCase.saveStatus">
              <span class="status-icon" [class]="specialCase.saveStatus">
                {{
                  specialCase.saveStatus === 'saved'
                    ? 'âœ“'
                    : specialCase.saveStatus === 'saving'
                      ? 'â³'
                      : 'âœ—'
                }}
              </span>
              <span class="status-text">
                {{ getSpecialCaseSaveStatusText(specialCase.saveStatus) }}
              </span>
            </div>
          </div>
        </div>

        <!-- ãã®ä»–ã®äº‹ä¾‹ã®ç°¡æ˜“ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div
          class="case-details"
          *ngIf="
            specialCase.type &&
            specialCase.type !== 'maternity-leave' &&
            specialCase.type !== 'childcare-leave'
          "
        >
          <div class="form-group full-width">
            <label [for]="'other-remarks-' + i">è©³ç´°ãƒ»å‚™è€ƒ:</label>
            <textarea
              [id]="'other-remarks-' + i"
              [(ngModel)]="specialCase.details.remarks"
              [placeholder]="getPlaceholderText(specialCase.type)"
            ></textarea>
          </div>

          <!-- ãã®ä»–ã®äº‹ä¾‹ã®ä¿å­˜ãƒœã‚¿ãƒ³ -->
          <div class="case-save-section">
            <button
              class="btn-save-case"
              (click)="saveSpecialCase(i)"
              [disabled]="!canSaveOtherCase(i)"
            >
              <i class="icon-save"></i>
              ã“ã®æƒ…å ±ã‚’ä¿å­˜
            </button>
            <div class="save-status" *ngIf="specialCase.saveStatus">
              <span class="status-icon" [class]="specialCase.saveStatus">
                {{
                  specialCase.saveStatus === 'saved'
                    ? 'âœ“'
                    : specialCase.saveStatus === 'saving'
                      ? 'â³'
                      : 'âœ—'
                }}
              </span>
              <span class="status-text">
                {{ getSpecialCaseSaveStatusText(specialCase.saveStatus) }}
              </span>
            </div>
          </div>
        </div>
      </div>

      <div class="add-case-section">
        <button class="btn-add-case" (click)="addSpecialCase()">
          <i class="icon-plus"></i>
          ç‰¹æ®Šäº‹ä¾‹ã‚’è¿½åŠ 
        </button>
      </div>
    </div>
  </div>

  <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
  <div class="action-buttons" *ngIf="!judgmentResult">
    <!-- åˆ¤å®šçµæœãŒãªã„æ™‚ã®ã¿è¡¨ç¤º -->
  </div>
</div>
