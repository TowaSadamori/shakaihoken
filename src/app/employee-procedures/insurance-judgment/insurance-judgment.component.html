<div class="judgment-container">
  <h2>社会保険対象者判定</h2>

  <!-- 対象者情報 -->
  <div class="employee-info">
    <h3>対象者情報</h3>
    <div class="info-grid">
      <div class="info-item">
        <div class="label">従業員名:</div>
        <span>{{ employeeName }}</span>
      </div>
      <div class="info-item">
        <div class="label">従業員番号:</div>
        <span>{{ employeeNumber }}</span>
      </div>
      <div class="info-item">
        <div class="label">生年月日:</div>
        <span>{{ birthDate }}</span>
      </div>
      <div class="info-item">
        <div class="label">年齢:</div>
        <span>{{ age }}歳</span>
      </div>
      <div class="info-item">
        <div class="label">事業所番号:</div>
        <span>{{ officeNumber }}</span>
      </div>
      <div class="info-item">
        <div class="label">事業所所在地:</div>
        <span>{{ officePrefecture }}</span>
      </div>
    </div>
  </div>

  <!-- 属性編集ボタン -->
  <div class="attribute-edit-section" *ngIf="!showQuestionnaire && !judgmentResult">
    <div class="edit-prompt">
      <p>従業員の属性を設定するために質問に答えてください</p>
      <button class="btn-primary" (click)="startAttributeEdit()">属性を編集する</button>
    </div>
  </div>

  <!-- 質問エリア -->
  <div class="questionnaire" *ngIf="showQuestionnaire && currentQuestion">
    <h3>質問 {{ getQuestionNumber() }}</h3>
    <div class="questions">
      <div class="question-item">
        <div class="question-text">{{ currentQuestion.text }}</div>

        <!-- 選択式質問 -->
        <div class="answer-options" *ngIf="currentQuestion.type === 'choice'">
          <label *ngFor="let choice of currentQuestion.choices">
            <input
              type="radio"
              [name]="currentQuestion.id"
              [value]="choice.value"
              [(ngModel)]="answers[currentQuestion.id]"
              (change)="updateAnswers()"
            />
            {{ choice.label }}
          </label>
        </div>

        <!-- はい/いいえ質問 -->
        <div class="answer-options" *ngIf="currentQuestion.type === 'yesno'">
          <label>
            <input
              type="radio"
              [name]="currentQuestion.id"
              value="yes"
              [(ngModel)]="answers[currentQuestion.id]"
              (change)="updateAnswers()"
            />
            はい
          </label>
          <label>
            <input
              type="radio"
              [name]="currentQuestion.id"
              value="no"
              [(ngModel)]="answers[currentQuestion.id]"
              (change)="updateAnswers()"
            />
            いいえ
          </label>
        </div>
      </div>
    </div>
  </div>

  <!-- 判定結果 -->
  <div class="judgment-result" *ngIf="judgmentResult">
    <h3>判定結果</h3>
    <div class="result-cards">
      <div class="result-card">
        <h4>健康保険</h4>
        <div
          class="status"
          [class]="judgmentResult.healthInsurance.eligible ? 'eligible' : 'not-eligible'"
        >
          {{ judgmentResult.healthInsurance.eligible ? '加入対象' : '加入対象外' }}
        </div>
        <p>{{ judgmentResult.healthInsurance.reason }}</p>
      </div>

      <div class="result-card">
        <h4>厚生年金保険</h4>
        <div
          class="status"
          [class]="judgmentResult.pensionInsurance.eligible ? 'eligible' : 'not-eligible'"
        >
          {{ judgmentResult.pensionInsurance.eligible ? '加入対象' : '加入対象外' }}
        </div>
        <p>{{ judgmentResult.pensionInsurance.reason }}</p>
      </div>

      <div class="result-card">
        <h4>介護保険</h4>
        <div
          class="status"
          [class]="judgmentResult.careInsurance?.eligible ? 'eligible' : 'not-eligible'"
        >
          {{ judgmentResult.careInsurance?.eligible ? '加入対象' : '加入対象外' }}
        </div>
        <p>{{ judgmentResult.careInsurance?.reason }}</p>
      </div>
    </div>
  </div>

  <!-- アクションボタン -->
  <div class="action-buttons">
    <!-- 左側：戻るボタン -->
    <div class="left-buttons">
      <button class="btn-back" (click)="goBack()">
        <i class="icon-arrow-left"></i>
        従業員一覧に戻る
      </button>
    </div>

    <!-- 右側：操作ボタン -->
    <div class="right-buttons">
      <button class="btn-reset" *ngIf="judgmentResult" (click)="resetQuestionnaire()">
        <i class="icon-refresh"></i>
        判定をやり直す
      </button>
      <button class="btn-save" *ngIf="judgmentResult" (click)="saveJudgment()">
        <i class="icon-save"></i>
        判定結果を保存
      </button>
    </div>
  </div>
</div>
